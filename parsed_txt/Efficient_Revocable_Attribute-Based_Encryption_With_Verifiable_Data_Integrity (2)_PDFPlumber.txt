This article has been accepted for publication in IEEE Internet of Things Journal. This is the author's version which has not been fully edited and content may change prior to final publication. Citation information: DOI 10.1109/JIOT.2023.3325996 1 Efficient Revocable Attribute-based Encryption with Verifiable Data Integrity Shaobo Chen, Jiguo Li, Yicheng Zhang, Jinguang Han Abstract—Nowadays, cloud computing and cloud storage ser- version of ciphertext-policy attribute-based encryption (CP- vices that can reduce the local workload are becoming increas- ABE) in 2011 [6]. Over the past ten or so years, ABE has inglypopular,allowingindividualandcorporateuserstoupload beenextensivelyexploredandextendedwithvariousfunctions data to the cloud. Since the user’s permissions in the system are besides access control, such as hidden access structures [7], notimmutable,theusersshouldhavedynamicaccess.Revocation of users who have been granted access to data is also a strong dynamic credentials [8], key escrow-free [9], [10], multi- needforcloudcomputingsystems.Inaddition,weshouldensure authorityABE[11],privacyprotection[12],outsourcingcom- the data integrity after the cloud server performs a revocation. putation [13]–[15], etc. Numerous ABE schemes [16]–[19] To address above issues, we propose a revocable attribute-based have been put forth in recent years to improve efficiency. Fast encryption scheme that protects the data integrity (RABE-DI). attribute-based message encryption (FAME) was proposed by Our scheme is more efficient compared with existing RABE-DI schemes.Inaddition,weprovethesemanticsecurityandintegrity Agrawal et al. in 2017 [17], which is an unbounded attribute ofthescheme.Experimentalresultshowsthatthesimilarscheme space ABE scheme with quick decryption. In the FAME is not as efficient as ours. scheme, arbitrary strings are used as attributes and decryption Index Terms—attribute-based encryption; full security; deci- inherentlyrequiresonly6pairingoperations.Itisveryefficient sional linear assumption; data integrity; comparedtotheABEschemewhosedecryptioncostislinearly related to the number of attributes. FAME scheme is also proventobefullysecure,comparedtosomeclassicalschemes I. INTRODUCTION [20], [21] which only achieve selective security. CLOUD computing and cloud storage services have be- Anotherissueisthattheaccessstructuredetermineswhatat- come increasingly popular among individuals and busi- tributesetcansatisfyit.InCP-ABE,theplaintextisencrypted nessesinrecentyearsbecauseoftheireconomicalandefficient into ciphertext under a particular access structure. The access features.Peoplestoretheirhugedatainthecloudoroutsource structure is generated at the time of encryption and remains cumbersomecomputingprogramstothecloudwhilethecloud unchanged. How to revoke access rights from some users by service providers charge for it. This may seem like a great changing the access structure is a challenging problem. The give-and-take business partnership but some problems arise. individual who encrypts the data, known as the data owner, In such an environment, the semantic security and integrity should have the authority to determine which individuals or of the user’s data are challenged [1]–[3]. Data confidentiality entities are granted access to the data. is usually addressed by encrypting the data and data integrity To illustrate this situation with an example, we consider requires verification of data. However, data in the cloud is that in a company the annual sales data is encrypted by usually shared by many users, which requires one-to-many the access structure A, which corresponds to the boolean cryptographic primitives. Attribute-based encryption (ABE) is formula T = (“accountant” ∨ “sales”). The company’s a widely known technique that solves this problem [4]. ABE accountant and all sales of the marketing department have hasbeenproventobeverysuitableforaccesscontrolanditis access to the report. Subsequently, the data owner, who widelyusedinmanyapplicationslikepaidbroadcasting,cloud is the manager of the company, seeks to enhance access services,andmedicaldataaccesscontrol.ABEhasundergone privileges in order to safeguard privacy and mitigate the significant development since its initial proposal by Sahai et risk of malicious competition among employees. The new al. in 2005 [5]. Notably, Waters introduced the first practical regulation requires that only management-level employees of the company have access to the report, that is, those with This work was supported by the National Natural Science Foundation of ‘senior’ attribute. In order to achieve this goal, the access China(62072104,61972095,U21A20465,61972190,U1736112,61772009). ThisworkwasalsosupportedbytheNaturalScienceFoundationoftheFujian structure for the encrypted report is therefore updated to the Province,China(2020J01159). new access structure A′, which corresponds to the boolean J. Li is with the College of Computer and Cyber Security, Fujian Nor- formulaT′ =(“accountant”∨“sales”)∧(“senior”).Cloud mal University, Fuzhou, China 350117 and also with the Key Labora- tory of Analytical Mathematics and Applications (Ministry of Education), server can realize the update of boolean formula from T Fuzhou,China350117;FujianProvincialKeyLaboratoryofNetworkSecu- to T′ and perform a revocation algorithm to re-encrypt the rity and Cryptology, Fuzhou, China 350117 (Corresponding author, E-mail: ciphertextoriginallyencryptedunderT totheciphertextunder ljg1688@163.com). S. Chen and Y. Zhang are with the College of Computer and Cy- T′. After this update, some employees with “junior” attribute ber Security, Fujian Normal University, Fuzhou, China 350117 (E-mail: are revoked, because their attributes no longer satisfy the m18565770601 1@163.com,Correspondingauthor:zyc 718@163.com). new access structure A′, which corresponds to the boolean J. Han is with the School of Cyber Science and Engineering, Southeast University,Nanjing,Jiangsu210096,China(Email:jghan22@gmail.com). formula T′. Fig.1 depicts this example. We consider one Authorized licensed use limited to: Digital University Kerala. Downloaded on November 17,2023 at 05:42:21 UTC from IEEE Xplore. Restrictions apply. © 2023 IEEE. Personal use is permitted, but republication/redistribution requires IEEE permission.(cid:13)(cid:10)See https://www.ieee.org/publications/rights/index.html for more information.This article has been accepted for publication in IEEE Internet of Things Journal. This is the author's version which has not been fully edited and content may change prior to final publication. Citation information: DOI 10.1109/JIOT.2023.3325996 2 (1) We present an efficient RFAME scheme with data in- tegrity. The scheme includes a mechanism to detect incorrect revocation performed by the cloud, which can be identified by the data user. (2) Our scheme does not require the data owner to perform revocation.Instead,thedataownercansimplyprovidethe cloud with a delegation, instructing it on how to perform the revocation. (3) We prove the security of our scheme by reducing it to the fully secure scheme [17]. Additionally, we prove that (cid:263)(cid:263)EEnnggiinneeeerr(cid:264)(cid:264) (cid:263)(cid:263)SSaalleess(cid:264)(cid:264) (cid:263)(cid:263)AAccccoouunnttaanntt(cid:264)(cid:264) (cid:263)(cid:263)AAccccoouunnttaanntt(cid:264)(cid:264) (cid:263)(cid:263)SSaalleess(cid:264)(cid:264) our scheme offers data integrity. (cid:263)(cid:263)JJuunniioorr(cid:264)(cid:264) (cid:263)(cid:263)JJuunniioorr(cid:264)(cid:264) (cid:263)(cid:263)SSeennIIoorr(cid:264)(cid:264) (cid:263)(cid:263)JJuunniioorr(cid:264)(cid:264) (cid:263)(cid:263)SSeenniioorr(cid:264)(cid:264) (4) Through experiments, we assess the execution time of variousalgorithms,includingencryption,decryption,and revocation. We illustrate the performance of our scheme andtheRABE-DIschemepresentedin[22].Ourscheme has more effective revocation and decryption. B. Related work A lot of work has been carried out after Sahai and Waters [5]presentedtheideaofABE,whichrequirestheattributeset to meet the access structure in order to decrypt the data. ABE isdividedintotwotypes:key-policyattribute-basedencryption (KP-ABE) [23], [24] and CP-ABE [25], [26], depending on whether the access structure belongs to the private key or ciphertext. Attribute revocation is a significant research area in ABE. It presents a challenging task due to the potential involvement (cid:263)(cid:263)EEnnggiinneeeerr(cid:264)(cid:264) (cid:263)(cid:263)SSaalleess(cid:264)(cid:264) (cid:263)(cid:263)AAccccoouunnttaanntt(cid:264)(cid:264) (cid:263)(cid:263)AAccccoouunnttaanntt(cid:264)(cid:264) (cid:263)(cid:263)SSaalleess(cid:264)(cid:264) of numerous users when updating a single attribute. Direct (cid:263)(cid:263)JJuunniioorr(cid:264)(cid:264) (cid:263)(cid:263)JJuunniioorr(cid:264)(cid:264) (cid:263)(cid:263)SSeennIIoorr(cid:264)(cid:264) (cid:263)(cid:263)JJuunniioorr(cid:264)(cid:264) (cid:263)(cid:263)SSeenniioorr(cid:264)(cid:264) revocation[27]–[29],acommonformofrevocation,isusually implementedintwoways.Oneistoaddatimestamptothekey Fig.1. Revocationprocessinacompany and the key generation center (KGC) broadcasts periodically to update the key. Another way is to add a revocation list more case, if the manager does not want the accountants to the ciphertext, which faces with the problem of excessive in the company to have access to the ciphertext, he/she can ciphertext size. Liu et al. [27] introduced a method of revoca- revoke the attribute “accountant” by modifying the boolean tion which is direct. This scheme incorporates the revocation formula of the access structure (“accountant”∨“sales”) as list directly into the ciphertext. However, the disadvantage (“accountant”∨“sales”)∧(“sales”). Since the revocation for this strategy is that the ciphertext’s length grows as time isdonebyacloudserver,sothedataintegrityafterrevocation passes. They dealt this by eliminating the expired portion needs to be guaranteed. In our model, we consider that cloud of the revocation list, thereby reducing the overall length of servers store the data uploaded by users correctly but may the ciphertext. Indirect revocation [8], [30] splits the user’s perform computational tasks inactively or incorrectly to save privileges of decryption into key and update material of key. their computational resources, thus failing to make sure the Therevokeduserdoesnotreceivethekeyupdatematerialfrom integrity. KGC anymore and loses the decryption privileges. Cui et al. [31] introduced a method that belongs to indirect revocation. A. Motivations and Contributions Their method builds upon the revocation method described in The existing revocable attribute-based encryption (RABE) [32] by incorporating a binary tree and fuzzy identity-based schemesoftenfallshortinensuringdataintegrity.WhileGeet encryption [5]. The method [32] decreases the scale of key al. [22] introduced a RABE scheme with data integrity, their updates from linear to logarithmic level. There are still some scheme is not efficient enough for achieving data integrity problems worth thinking about revocation. For example, how protection. Thus, our objective is to enhance the efficiency of to revoke malicious users quickly, and how to decrease the revocation and decryption processes while safeguarding data computational burden during the revocation. The scheme [31] integrity. To accomplish this, we leverage the advantages of reduces the computational cost for data users with the help FAME[17],whichisamoreefficientschemeintermsofboth of auxiliary servers. Another issue is that the revoked user encryption and decryption. Our research focuses on imple- shouldn’thavetheprivilegetodecryptthenewciphertextafter menting revocation mechanisms and preserving data integrity revocation, also known as revocation with forward security. within the framework of FAME. Our main contributions are Becausethecloudservermayperformrevocationoperations summarized as follows. dishonestly, data integrity needs to be considered during the Authorized licensed use limited to: Digital University Kerala. Downloaded on November 17,2023 at 05:42:21 UTC from IEEE Xplore. Restrictions apply. © 2023 IEEE. Personal use is permitted, but republication/redistribution requires IEEE permission.(cid:13)(cid:10)See https://www.ieee.org/publications/rights/index.html for more information.This article has been accepted for publication in IEEE Internet of Things Journal. This is the author's version which has not been fully edited and content may change prior to final publication. Citation information: DOI 10.1109/JIOT.2023.3325996 3 revocation process. It implies that it’s imperative to guarantee (3) Computable: It’s very efficient to caculate e(u,v) for all that the encrypted data in both the newly created ciphertext u∈G,v ∈H. fromrevocationandtheoriginalciphertextarethesame.Some Definition 1 (Discrete Logarithm Assumption [42]). Let RABE schemes [29], [30], [33] are not able to guarantee data (p,G,G ,e,g) be a bilinear group system of prime order. integrity. A common solution is to verify the message being T Given a tuple (p,G,G ,e,g,gζ) where g ∈ G,ζ ∈ Z∗. The encrypted. Lai et al. [34] proposed a method to verify data T p discrete logarithm assumption indicates that a probabilistic integritybygivingacommitmenttothemessageandarandom polynomial time (PPT) adversary A has a negligible advan- message in the ciphertext. We use this verification method to tageinfindingtheintegerζ.Informalterms,theadvantageof ensure the data integrity of our scheme. suchanadversaryPr[A(p,G,G ,e,g,gζ)=ζ]isnegligible. Proxy re-encryption (PRE) is a common method in cloud T services and attribute-based proxy re-encryption can be used to achieve revocation. Data owner grants the proxy server to B. Access structure performre-encryption,whichencryptsagainontheciphertext, The access structure [43] requires an attribute set to be achievingtheeffectthattheoriginaldataisdirectlyencrypted granted permissions when its requirements are met. The fol- under the new access structure. Li et al. [35] presented lowing statement provides a precise definition. the formal definition, security model and construction of certificate-based conditional proxy re-encryption. It is a new Definition 2. The attribute universe is represented by the cryptographyprimitivewhichonlytheciphertextmatchingone symbol U, A represents an access structure which consists of condition set by the delegatoris re-encrypted correctly by the U’snon-emptysubsets,i.e.,A⊆2U\{0}.ForanyB,C ⊆U, proxy.Inordertoimproveperformance,Luetal.[36]provided if B ⊆C and B ∈A, then C ∈A, it is said to be monotone. acertificate-basedproxyre-encryptionschemewithoutpairing Fromthepointofcomprehensibility,monotonicitysuggests operation. Shao et al. [37] proposed a bidirectional PRE that a larger attribute set implies greater privileges, so adding scheme, in which a semi-trusted proxy server can convert the attributes to an attribute set does not reduce its privileges but ciphertext under Alice’s public key and the ciphertext under only makes it more powerful. Bob’spublickeytoeachotherbyusingadelegatekey.During A boolean formula T corresponds to an access structure thewholeprocess,theproxyservercannotobtaintheplaintext A = (M,τ) where M is a matrix and τ is a function. and the ciphertext’s size does not increase with the number of The boolean formula T determines the number of rows and re-encryptions.Dependingonthelocationoftheaccesspolicy, columns of matrix M and τ maps M’s row to a specific attribute-based PRE is likewise categorized into ciphertext- attribute. Some simple and efficient conversion methods were policy attribute-based proxy re-encryption (CP-ABPRE) and proposed. For instance, in [44], Liu and Cao proposed an key-policy attribute-based proxy re-encryption (CP-ABPRE). efficientalgorithmtoconvertthebooleanformulaintoassmall In order to achieve more effective fine-grained access control, as possible matrix thus reducing the communication cost. Li et al. [38] proposed a CP-ABPRE scheme with key homo- The scheme in this work does not involve the secret recov- morphism using restricted pseudo-random functions. In order ery,butonlythelinearreconfigurationpropertyoflinearsecret to resist quantum attacks, Luo et al. [39] proposed the first sharing scheme (LSSS [43]) is used, described as follows. KP-ABPRE scheme based on learning with errors problem. Let S be an attribute set and I ={i|i∈{1,...,n },τ(i)∈ Proxy server can reduce the computational pressure on users, 1 S} be the set of rows in M that corresponding to S. If there but it also brings credibility issues. It is necessary for the isawaytocombinetherowsofmatrixM suchthattheresult data user to validate the results of server execution. Recently, is equal to (1,0,0,...,0), then we describe the attribute set S Ge et al. [40] proposed a verifiable PRE scheme that allows as fulfilling the access structure (M,τ). More formally, if the users to detect and refuse to pay for services if the proxy attribute set S satisfies the access structure (M,τ), then there server does not perform correctly. Deng et al. [41] proposed must exist a set of constant coefficients {θ } such that the a technique where a proxy server converts an ABE ciphertext (cid:80) i i∈I following equation holds θ M = (1,0,0,...,0) where to a ciphertext encrypted by identity-based encryption, thus i∈I i i M is the i-th row of M. reducing the decryption cost at the user end. i We use A (cid:101) = (M(cid:102),f(cid:101)) to denote the delegation access struc- ture corresponds to boolean formula T(cid:101) and A′ = (M′,f′) II. PRELIMINARIES to denote the revoked access structure corresponds to boolean formula T′. A. Complexity assumption Let (p,G,H,G ,e,g,h) be a prime order bilinear group T III. SYSTEMARCHITECTUREANDDEFINITIONS system. The multiplicative cyclic groups G, H, and G have T prime order p. g and h are generator of the group G and A. System architecture H, respectively. If the subsequent conditions hold, then e : Our RFAME system requires four entities, which are the G×H→G T is a bilinear pairing. data owner (DO), data user (DU), trusted authority center (1) Bilinear:e(ux,vy) = e(u,v)xy for all u ∈ G,v ∈ H and (AC), and cloud server (CS). x,y ∈Z∗; (1) AC takes charge of setting up the entire system and p (2) Non-degenerate: e(u,v)̸=1 whenever u,v ̸=1G; generatingallpublicparametersaccordingtothesecurity Authorized licensed use limited to: Digital University Kerala. Downloaded on November 17,2023 at 05:42:21 UTC from IEEE Xplore. Restrictions apply. © 2023 IEEE. Personal use is permitted, but republication/redistribution requires IEEE permission.(cid:13)(cid:10)See https://www.ieee.org/publications/rights/index.html for more information.This article has been accepted for publication in IEEE Internet of Things Journal. This is the author's version which has not been fully edited and content may change prior to final publication. Citation information: DOI 10.1109/JIOT.2023.3325996 4 parameters. The authority center also uses the master private key to create private keys for the data users. (2) DO makes the access structure and decides who can access its data accordingly. Data is encrypted under the specified access structure and transferred to the cloud. Upload: CT (3) CS keeps the ciphertext uploaded by data owner and performs the revocation operation. Upload: DG (4) Data users are able to obtain the ciphertext and recover DDaattaa oowwnneerr CCClllooouuuddd ssseeerrrvvveeerrr the plaintext with their own secret key. Data users also can confirm the data integrity. y e k c ilb u P :d ao ln w o D txetre h p iC B. Threat model Threat models are used to portray adversaries. Different Secret key 11.. VVeerriiffyy iinntteeggrriittyy adversaries have different capabilities and goals, this paper ((iinncclluuddeedd iinn tthhee DDeeccrryypptt)) deals with two adversaries in the threat model [22]. The Public key 22.. RReeccoovveerr tthhee first adversary can be any entity whose main target is to DDaattaa uusseerr mmeessssaaggee mm compromise the confidentiality of the data. This adversary Authority center doesn’t possess a valid key, but their goal is to decrypt the Fig.2. OurRFAME-DIscheme’ssystemarchitecture ciphertext to achieve the plaintext. The second adversary, typically represented by a CS, aims to tamper with the data integrity by generating incorrect revoked ciphertext. This Decrypt (sk′,CT ,CT′): The data user takes their re csum meansthattheywanttocorruptthedatainawaythatmakesit privatekeysk′ whichisdifferentfromsk,apartoftheoriginal unreliable or misleading. Note that the threat model assumes ciphertext CT (explicitly, it is the checksum in CT.) and csum there is no collaboration between CS and the revoked user. therevokedciphertextCT′ downloadedfromthecloudserver In other words, CS won’t share the original ciphertext with asinputiftheattributesetS′ abouttheprivatekeysk′ matches the revoked user, as doing so would allow the revoked user to theaccessstructureA′ intheciphertextCT′ andthecalculated decrypt it directly. checksum equals the CT and the checksum embedded in csum CT′, then it outputs the message m, else it outputs ⊥. C. Syntax of Revocable FAME with Data Integrity (RFAME- DI) D. Security model OurRFAME-DIschemeiscomprisedofthefollowingseven The two security models [22] required for the RFAME-DI algorithms. The process of execution is depicted in Fig.2. scheme are described separately below. Setup(1λ): The security parameter λ is provided as input IND-CPA security. totheauthoritycenter,whichthengeneratesthesystempublic Informally, if no algorithm can distinguish between m 0 parameters PP and the master private key msk. and m encrypted under the chosen access structure A∗, the 1 KeyGen(msk,S):Theauthoritycenterproducestheprivate schemeresiststhechosenplaintextattack(CPA),aslongasthe keyskforthedatauserbyenteringthemasterprivatekeymsk algorithm is not authorized with the corresponding decryption and the attribute set S corresponding to data user. key. Such an attack occurs at any stage of the cryptographic Encrypt(m,A,PP):Thedataownerusestheaccessstruc- scheme, so the choice of the attacked access structure A∗ ture A to encrypt the message m and then outputs the depends on the private key and the public parameters pos- ciphertext CT. sessed by the adversary. The scheme considered in this case Delegate(A (cid:101)): The data owner takes the delegation access will obtain adaptive or full security. In a less robust model structure A (cid:101) as input, and then computes and takes the delega- referred to as selective security, the access structure A∗ is tion DG based on the new attributes involved in A (cid:101) as output. selected before the system is deployed so as to prevent CPA, Revoke(CT,DG): The cloud server takes the original ci- such an idealized definition is unlikely to occur in reality. phertext CT and the delegation DG as input and takes the A RFAME-DI scheme achieves CPA security when the A’s revoked ciphertext CT′ whose corresponding access structure advantage in the subsequent game is negligible. isA′ asoutput.ThebooleanformulacorrespondingtoA′ here Setup: ThechallengerC runsthescheme’sSetupalgorithm is T′ =(TANDT(cid:101)). to produce public parameters and a master secret key during Decrypt (sk,CT): The data user takes their private key this phase. The public parameters are then shared by C and or sk and the original ciphertext CT as input, where the private A. key corresponds to the attribute set S and the access structure Query: A submits a query to obtain the secret keys sk , S1 contained in the ciphertext CT is A. It outputs the message ...,sk , where S can’t satisfy the access structure A∗ that m, when the attribute set S matches A and the calculated will b S e q1 challenged i for i ∈ {1,2,...,q }. A also makes a 1 checksum equals the checksum embedded in CT, else it delegation text query and gets a series of delegation texts outputs ⊥. dt ,dt ,...,dt . 1 2 q2 Authorized licensed use limited to: Digital University Kerala. Downloaded on November 17,2023 at 05:42:21 UTC from IEEE Xplore. Restrictions apply. © 2023 IEEE. Personal use is permitted, but republication/redistribution requires IEEE permission.(cid:13)(cid:10)See https://www.ieee.org/publications/rights/index.html for more information.This article has been accepted for publication in IEEE Internet of Things Journal. This is the author's version which has not been fully edited and content may change prior to final publication. Citation information: DOI 10.1109/JIOT.2023.3325996 5 Challenge: A chooses message m 0 and message m 1 of TABLEI the same bit length. These messages are then sent to C by A. SYMBOLDESCRIPTIONLIST C takes these messages and generates a challenge ciphertext CT∗ by executing the algorithm Enc(m ,A∗). Here, σ is a Symbols Description σ randomly chosen value from the set {0,1}. C then sends the λ Securityparameter CT∗ back to A. PP Publicparameters Query: This phase is the same as above. (S,sk0,{sky}y∈S,sk′) PrivatekeyforattributesetS Guess: A’s advantage in winning the IND-CPA secu- H Hashfunctionmapping{0,1}∗ toG r |P ity r[σ ga ′ m = e σ is ] − defi 1 n / e 2 d |, b w y he t r h e e σ e ′ qu is ati t o h n e a A d d v v e A I rs N a D ry − ’s CP g A ue ( s λ s ) fo = r H HashfunctionmappingG T toZ∗ p M Matrixwithn1 rowsandn2 columns σ. τ Rowlabelingfunction Integrity. The data integrity of the RABE-DI scheme is captured by col1 FirstcolumnofmatrixM the game involving C and A. The scheme guarantees data S Attributeset integrity if the advantage of an adversary A is negligible. y AttributeintheattributesetS Setup: C runs the scheme’s Setup algorithm to produce m,m′ MessageandrandomvaluefromG T public parameters and a master secret key during this phase. e Bilinearmapfunction The public parameters are then shared by C and A. Query: A submits a query to obtain the secret keys ei Ciphertextform′ sk ,...,sk . ⊥ Dataintegrityexceptionsymbol S1 Sq Challenge: Aselectsamessagemandanaccessstructure E A n a c n ( d m t , h A e ) n a t n ra d ns re m tu it r s ns th i e t’ m s r t e o su C l . t C CT en b cr a y c p k ts to m A b . y algorithm sk y,z =H(y1z) β α 1 z r1 ·H(y2z) β α 2 z r2 ·H(y3z) r1 α + z r2 ·g r1 α + z r2, Query: This phase is the same as above. sk z ′ =gγz·H(011z) β α 1 z r1 ·H(012z) β α 2 z r2 ·H(013z) r1 α + z r2 ·gα σ z ′ . Output: A produces an attribute set S′ and a r D ev e o c k re e ( d sk S c ′ ip , h C e T rt , e C xt T′ C ) = T′. m′ A , wh i e s re c m on ′ s i i s de n r e e i d the t r o m w n i o n r ⊥ if . s s k k A ′ = ut ( h S = o , ri s t k y , ( { s c k s e k 1 n ′, te s } r k 2 ′, l g e , γ t s s 3 k − ′ σ ) s ′ k f ) o y r a a n tt = d ribu o te u ( t s s p k e u t y t , s S 1 , . s s k e y c ,2 re , t g−σ k y e ) y , We notate the A’s advantage in winning the integrity game is 0 y y∈S Encrypt(m,A,PP): Data owner selects s ,s and sˆ,sˆ Pr[Awins]. 1 2 1 2 from Z randomly, computes c = (c ,c ,c ) = p 0 0,1 0,2 0,3 IV. CONSTRUCTION (H 1 s1,H 2 s2,hs1+s2) and e 0 = (e 0,1 ,e 0,2 ,e 0,3 ) = (H 1 sˆ1,H 2 sˆ2, hsˆ1+sˆ2).SupposethatM isamatrixofn 1 ×n 2 andM i,j isan Inthispart,webeginbypresentingarevisedversionofthe element of M, where i and j represent the row and column FAMEconstruction,whichincludesanadditionalcommitment number, respectively. For k = 1,2,3 and i = 1,...,n , the 1 to the ciphertext. Subsequently, we demonstrate that this data owner computes modified version of FAME offers full security. Furthermore, we proposed the revocable FAME scheme with data integrity. c i,k =H(τ(i)k1)s1 ·H(τ(i)k2)s2 · The meaning of the mathematical symbols involved in the scheme are shown in Table I below. (cid:81)n j= 2 1 [H(0jk1)s1 ·H(0jk2)s2]Mi,j, Data owner lets c = (c ,c ,c ) and computes ct′ = i i,1 i,2 i,3 A. FAME scheme with data integrity Ts1 ·Ts2 ·m, where message m belongs to group G , and 1 2 T The scheme comprises four algorithms as follows. thendataownerselectsm′ fromG T randomly.Fork =1,2,3 Setup(1λ): Let (p,G,H,G T ,e,g,h) be a prime order bi- and i=1,...,n 1 , the data owner computes f li r n o e m ar Z g ∗ rou an p d sy s s e t l e e m ct . s A γ ut , h γ or , it γ y c r e a n n t d er om se l l y ec f t r s o α m 1 , Z α 2 a ra n n d do co m m ly - e i,k =H(τ(i)k1)sˆ1 ·H(τ(i)k2)sˆ2 · p 1 2 3 p putes H 1 = hα1,H 2 = hα2,T 1 = e(g,h)γ1α1+γ3,T 2 = (cid:81)n2 [H(0jk1)sˆ1 ·H(0jk2)sˆ2]Mi,j, e(g,h)γ2α2+γ3. Authority center also chooses two hash func- j=1 tion H : {0,1}∗ → G and H : G → Z∗ and selects Data owner lets e = (e ,e ,e ) and computes ct′′ = T p i i,1 i,2 i,3 φ,ϕ randomly from G, then authority center outputs public Tsˆ1 ·Tsˆ2 ·m′, csum=φH(m)ϕH(m′). 1 2 parametersPP =(g,h,H ,H ,T ,T ,φ,ϕ,H,H).Authority Data owner outputs ciphertext CT = 1 2 1 2 centerselectsβ ,β randomlyfromZ∗ andoutputsthemaster (A,c ,c ,...,c ,ct′,e ,e ,...,e ,ct′′,csum). 1 2 p 0 1 n1 0 1 n1 private key msk =(α 1 ,α 2 ,β 1 ,β 2 ,gγ1,gγ2,gγ3). Decrypt or (sk,CT): Data user checks whether the private KeyGen(msk,S): Authority center selects r ,r ran- key’s attribute set S matches the ciphertext’s access structure 1 2 domly from Z , and uses β ,β to compute sk = A=(M,τ).Ifnot,thealgorithmabortsafterprintingtheerror p 1 2 0 (hβ1r1,hβ2r2,hr1+r2). We use sk 0,1 ,sk 0,2 ,sk 0,3 to represent symbol ⊥. Otherwise, the data user performs the following the three subterms of sk . Authority center selects σ ,σ′ operations. Data user finds the set I ⊂{1,2,...,n } and I = 0 y 1 randomly from Z . For z = 1,2 and all y ∈ S, authority {j : τ(j) ∈ S} and then finds a constant set {θ } that p i i∈I (cid:80) center computes satisfy θ ·M =(1,0,...,0). Data user computes i∈I i i Authorized licensed use limited to: Digital University Kerala. Downloaded on November 17,2023 at 05:42:21 UTC from IEEE Xplore. Restrictions apply. © 2023 IEEE. Personal use is permitted, but republication/redistribution requires IEEE permission.(cid:13)(cid:10)See https://www.ieee.org/publications/rights/index.html for more information.This article has been accepted for publication in IEEE Internet of Things Journal. This is the author's version which has not been fully edited and content may change prior to final publication. Citation information: DOI 10.1109/JIOT.2023.3325996 6 num= To perform a revocation of a file, the cloud needs a ct′·e( (cid:81) cθi ,sk )·e( (cid:81) cθi ,sk )·e( (cid:81) cθi ,sk ), delegation DG provided by the data owner of this file and i∈I i,1 0,1 i∈I i,2 0,2 i∈I i,3 0,3 thecloudperformstherevocationalgorithmbasedontheDG. den=e(sk′ · (cid:81) skθi ,ct )·e(sk′ · 1 i∈I τ(i),1 0,1 2 To implement the delegation,the dataowner randomlyselects (cid:81) i∈I sk τ θi (i),2 ,ct 0,2 )·e(sk 3 ′ · (cid:81) i∈I sk τ θi (i),3 ,ct 0,3 ), s 1 ,s 2 and saves s 1 ,s 2 as a file identifier for that file during the encryption phase. In the delegation phase, the data owner and outputs m = num/den. A similar calculation can be performed for (e ,e ,...,e ,ct′′) and outputs m′. At last, needs to use s 1 ,s 2 to generate the dt which is a part of DG. if csum = φH(m 0 )ϕ 1 H(m′) n h 1 olds, the data user outputs m, Delegate(A (cid:101)): The data owner specifies an access structure otherwise outputs ⊥. A (cid:101) =(M(cid:102),τ (cid:101) ),whereM(cid:102)isan (cid:102)1 ×n (cid:102)2 matrixandτ (cid:101) isafunction that converts a row from the matrix M(cid:102) into an attribute. Correctness. Here we demonstrate that when the private keysk includesthenecessaryattributesinAofavalidFAME Then the following calculation is done for the new attributes contained in the access structure A (cid:101) and k =1,2,3. ciphertext, our decryption algorithm will always recover the cor F r r e o c m t m th e e ss c a t g ′ e w w e i k th no a w ce th rt a a t in if ty w o e f w 1 i . shtogetm,theessence dt k = (cid:81)n i (cid:102) = 1 1 H(τ (cid:101) (i)k1)s1 ·H(τ (cid:101) (i)k1)s2 is that we need to compute Ts1 ·Ts2. For k = 1,2,3, using Data owner lets dt = (dt 1 ,dt 2 ,dt 3 ) and outputs delegation the equation (cid:80) θ M = ( 1 1,0,0 2 ,...,0), we can calculate DG=(dt,A (cid:101)) for the could server. i∈I i i (cid:81) cθi . Revoke(CT,DG): The cloud server inputs a ciphertext i∈I i,k CT = (A,c ,c ,...,c ,ct′,e ,e ,...,e ,ct′′,csum) and a 0 1 n1 0 1 n1 delegation DG = (dt,A (cid:101)). M is a matrix with n 1 rows and (cid:89) cθi = (cid:89) (H(τ(i)k1)θis1 ·H(τ(i)k2)θis2 · (cid:89) n2 [H(0jk1)s1· n 2 columns and M(cid:102)is a matrix with n (cid:102)1 rows and n (cid:102)2 columns. i,k The cloud server produces a revoked ciphertext under access i∈I i∈I j=1 structure A′ =(M′,τ′). The cloud server constructs (M′,τ′) H(0jk2)s2]θiMi,j) as = (cid:89) n2 [H(0jk1)s1 ·H(0jk2)s2] (cid:80) i∈I θiMi,j· M′ =   M | −col 1 | 0  , j=1 (cid:89) 0 | M(cid:102) ( (H(τ(i)k1)θis1 ·H(τ(i)k2)θis2) i∈I (cid:40) =[H(01k1)s1 ·H(01k2)s2] (cid:80) i∈I θiMi,j· τ′ = τ(j) j ≤n 1 τ(j−n ) j >n (cid:89) (cid:101) 1 1 ( (H(τ(i)k1)θis1 ·H(τ(i)k2)θis2) i∈I where col 1 is first column of M. M′ is a n′ 1 ×n′ 2 matrix, where n′ =n +n ,n′ =n +n . The cloud selects s′,s′ This allows us to compute the last three pairing operations 1 1 (cid:102)1 2 2 (cid:102)2 1 2 from Z randomly and computes revoked ciphertext in num, we calculate p num/ct′ = c ¯ t′ =ct′·T 1 s ′ 1·T 2 s ′ 2, c¯ 0 =(c 0,1 ·H 1 s ′ 1,c 0,2 ·H 2 s ′ 2,c 0,3 ·hs ′ 1 +s ′ 2), e( (cid:81) H t ( ∈ 0 { 1 1 3 ,2 t } ) [ , e h ( ) H (r ( 1 0 + 1 r 1 2 t )s ) t ,h · ) (cid:81) β1r1s ( t e · ( e H (H (τ ( ( 0 i) 1 1 2 t t ) ) θ , i h , ) h β ) 2 β r 1 2 r s 1 t s · t · c i ¯ ,k =c i,k ·H(τ(i)k1)s ′ 1·H(τ(i)k2)s ′ 2· (cid:81)n j= ′ 2 1 [H(0jk1)s ′ 1· e(H(τ(i)2t)θi,h)β2r2st ·e i ( ∈ H I (τ(i)3t)θi,h)(r1+r2)st)]. H(0jk2)s ′ 2]M i ′ ,j, where i∈[1,n 1 ]. When the above num/ct′ and the related term in den are c i ¯ ,k =dt k ·H(τ(i)k1)s ′ 1 ·H(τ(i)k2)s ′ 2 · (cid:81)n j= ′ 2 1 [H(0jk1)s ′ 1 · eliminated, we get the inverse of H(0jk2)s ′ 2]M i ′ ,j, where i∈[n 1 +1,n′ 1 ]. ( (cid:81) t∈{1,2} e(gγt ·g (cid:81) α σ ′ t · (cid:81) g− i∈ θ I iσ g τ θ ( i i) σ α , τ t h (i) s1 , + h s α 2 t ) st))·e(gγ3 ·g−σ ′ · n sa ′ 1 m T a h e n e d w c c a l s y o u u a m d s a s = e b r o v c v s e e u r . m le . ts T c h ¯ i e = e¯ 0 , ( e¯ c¯ 1 i, , 1 . , .. c¯ , i, e¯ 2 n , 1 c¯ i c ,3 a ) n f b o e r g i ot f t r e o n m in 1 th to e i∈I The revoked ciphertext is CT′ =(A′,c¯ ,c¯ ,...,c¯ ,c ¯ t′, Simply organizing the above term we get 0 1 n′ e(g,h)γ1α1s1+γ2α2s2+γ3(s1+s2), it is evident that this is e¯ 0 ,e¯ 1 ,...,e¯ n′ ,c ¯ t′′,csum). 1 1 the Ts1 ·Ts2 we want. Hence, the message m is recovered Decrypt (sk′,CT ,CT′): The data user enters the 1 2 re csum successfully. Similarly, we can obtain m′. private key sk′, which corresponds to the attribute set S′. The data user also enters the checksum in original ciphertext CT and revoked ciphertext CT′. First, the data user csum B. RFAME-DI scheme verifies whether csum is equal to CT . If not, the data csum The RFAME-DI scheme is a further improvement on the user outputs an error symbol ⊥ and aborts. In the second FAME scheme with data integrity. The Setup, KeyGen, step, the data user checks if the attribute set S′ meets the Encrypt, Decrypt of our RFAME-DI scheme is the same access structure (M′,τ′). If it doesn’t satisfy, the algorithm or as the scheme above. To achieve revocation, we add three aborts after printing ⊥. Otherwise, the data user finds a set algorithms Delegate, Revoke and Decrypt as described I′ ⊂ {1,2,...,n′} where I′ = {j : τ′(j) ∈ S′} and a set re 1 below. of constants {θ′} which elements belong to Z∗. Such that i i∈I′ p Authorized licensed use limited to: Digital University Kerala. Downloaded on November 17,2023 at 05:42:21 UTC from IEEE Xplore. Restrictions apply. © 2023 IEEE. Personal use is permitted, but republication/redistribution requires IEEE permission.(cid:13)(cid:10)See https://www.ieee.org/publications/rights/index.html for more information.This article has been accepted for publication in IEEE Internet of Things Journal. This is the author's version which has not been fully edited and content may change prior to final publication. Citation information: DOI 10.1109/JIOT.2023.3325996 7 (cid:80) i∈I′ θ i ′ ·M i ′ =(1,0,0,...,0). Then, the data user calculates (cid:80) i∈[1,n′] θ i ′ ·M i ′ = (1,0,0,...,0) ∈ Zn p ′ 1. We can construct u m se a r n c d h m ec ′ ks in w th h e et s h a e m r e cs w u a m y a = s i φ n H D (m ec ) r ϕ y H p (m t o ′ r ) . . A If t l t a h s e t, e t q h u e a d ti a o t n a {θ i =θ i ′ 1 } i∈[1,n1] and {θ(cid:101)i =θ i+n1 } i∈[1,n(cid:102)1] such that holds, the algorithm exports m, else prints ⊥. (cid:88) ′ ′ θ ·M =(1,0,0,...,0) Note that Decrypt re can be considered as three execution i i phases: pre-verification, decryption, and verification. The pre- i∈[1,n′] 1 verification is to save computational cost for the user when n1 n(cid:102)1 n1 n(cid:102)1 (cid:122) (cid:125)(cid:124) (cid:123)(cid:122) (cid:125)(cid:124) (cid:123) (cid:122) (cid:125)(cid:124) (cid:123)(cid:122) (cid:125)(cid:124) (cid:123) thedataintegrityhasbeenbroken.Ifthecloudservertampers =(1,0,...,0,−1,0,...,0)+(0,...,0,1,0,...,0) with the checksum of original ciphertext, which makes it (cid:88) ′ (cid:88) ′ unequal to the checksum of CT′, this will cause an exception = θ i ·M i + θ(cid:101)i ·M i+n1 to be thrown from the pre-validation phase when the user i∈[1,n1] i∈[1,n(cid:102)1] executes Decrypt re . However, this does not do the cloud (cid:88) (cid:88) (cid:122) (cid:125) n(cid:102) (cid:124) 1 (cid:123) serveranyfavorsandinvitesrecoursefromtheuser,whomay =( θ ·M , θ ·(−col ,0,...,0)) i i i 1,i believe that the cloud server has compromised the integrity i∈[1,n1] i∈[1,n1] of the data. This may result in the user refusing to pay n1 the cloud service provider. A failure in the pre-verification +( (cid:88) θ(cid:101)i · (cid:122) (0, (cid:125) .. (cid:124) .,0 (cid:123) ), (cid:88) θ(cid:101)i ·M(cid:102)i ). and verification phases throws an exception of data integrity. i∈[1,n(cid:102)1] i∈[1,n(cid:102)1] Therefore it is reasonable to assume that the cloud server (cid:80) will not tamper with CT sum to affect the execution result of Fromtheaboveequationitcanbeinferredthat i∈[1,n1] θ i · the user’s algorithm Decrypt re . Furthermore, in practice, the M i = (1,0,0,...,0) ∈ Zn p 1 and (cid:80) i∈[1,n(cid:102)1] θ(cid:101)i · M(cid:102)i = data owner can generate signature for the checksum of each (1,0,0,...,0) ∈ Zn(cid:102)1. Thus, the LSSS access structures M p ciphertext he uploads so that the cloud server cannot forge it. and M(cid:102) are both valid. Correctness. Algorithm Decrypt is the equivalent of re the original decryption algorithm Decrypt except for the or V. SECURITYANALYSIS first step, the checksum of the original ciphertext CT is csum compared with the checksum in the revoked ciphertext CT′. First, we prove the confidentiality of the modified FAME Therefore,aslongasCT′ isavalidciphertextundertheaccess scheme by reducing it to the original FAME scheme. We then structure (M′,τ′), algorithm Decrypt naturally satisfies the demonstrate the semantic security of the proposed revocable re correctness. In the following, we show that the CT′ produced FAME with data integrity scheme. Finally, we give a data integrity proof of our formal scheme by reducing to the through Revoke is correct by lemma 1. discrete logarithm assumption. Lemma 1. If the above M and M(cid:102) are valid LSSS access structures, then M′ is a valid LSSS access structure, and vice Theorem 1. The FAME with data integrity scheme is fully IND-CPA secure if Shashank’s FAME scheme [17] is fully versa. IND-CPA secure. proof: Due to the fact that both (M,τ) and (M(cid:102),τ (cid:101) ) Proof:ThesimulatorB canbebuilttobreaktheunderlying are valid, there are two sets of constants {θ } and i i∈[1,n1] FAME scheme’s full security by communicating with the {θ(cid:101)i } i∈[1,n(cid:102)1] which elements both belong to Z∗ p , such that challenger C, if a A exists that can break the security of (cid:80) i∈[1,n1] θ i · M i = (1,0,0,...,0) ∈ Zn p 1 and (cid:80) i∈[1,n(cid:102)1] θ(cid:101)i · FAME-DI scheme. M(cid:102)i = (1,0,0,...,0) ∈ Zn p (cid:102)1, respectively. We can then use •Setup.B obtainsthebasicparameters(p,G,H,G T ,e,H 1 , f { o θ l i l } o i w ∈ i [1 n , g n1 w ] a a y n , d w { h θ e (cid:101)i r } e i∈ n [ ′ 1, = n(cid:102)1] n to + c n ons . truct {θ i ′} i∈[1,n′ 1 ] in the h H α 2 2 , , T T 1 1 ,T = 2 , e H (g ) ,h b ) y γ1α c 1 a + l γ li 3 n , g T 2 C = , e w ( h g e , r h e )γ2 H α 1 2+γ = 3. B h fi α r 1 s , t H se 2 lec = ts (cid:40) 1 1 (cid:102)1 a hash H that maps from G to Z∗, and then randomly θ ,i∈[1,n ] T p θ′ = i 1 selects two elements ϕ,φ from the group G. Then B adds i θ(cid:101)i−n1 ,i∈[n 1 +1,n′ 1 ] these to the base parameters to form the public parameters It is easy to deduce from the formula that, PP = (ϕ,φ,H ,H ,T ,T ,H,H) to A, and sends them to 1 2 1 2 A. (cid:88) ′ ′ (cid:88) ′ (cid:88) ′ • Query. A queries a private key, then B queries a private θ i ·M i = θ i ·M i + θ(cid:101)i ·M i+n1 keytoContheattributesetS whichisthesameasthequeryof i∈[1,n′ 1 ] i∈[1,n1] i∈[1,n(cid:102)1] A.ThenB forwardsthereturnofC toA.Acanalsoinitiatea n1 n(cid:102)1 n1 n(cid:102)1 delegation query to access structure A (cid:101) =(M(cid:102),τ (cid:101) ). B randomly (cid:122) (cid:125)(cid:124) (cid:123)(cid:122) (cid:125)(cid:124) (cid:123) (cid:122) (cid:125)(cid:124) (cid:123)(cid:122) (cid:125)(cid:124) (cid:123) =(1,0,...,0,−1,0,...,0)+(0,...,0,1,0,...,0) selects two random numbers s a and s b and computes dt k = =(1,0,0,...,0)∈Zn p ′ 1 (cid:81) the n i (cid:102) n = 1 1 B H f ( o τ (cid:101) r ( w i) a k rd 1 s )s d a t · to H A (τ (cid:101) . (i)k1)sb, sets dt = (dt 1 ,dt 2 ,dt 3 ), • Challenge. A sends message m and message m of 0 1 Thus, (M′,τ′) is valid LSSS access structures. the same bit length and the access structure A∗ = (M∗,τ∗) Conversely, if (M′,τ′) is valid, there exists a set of con- intendedtobechallengedtoB.B forwardsm ,m andA∗ to 0 1 stants{θ′} whichelementsbothbelongtoZ∗,suchthat C.C tossesarandomcointodeterminethevalueofσ ∈{0,1} i i∈[1,n′] p 1 Authorized licensed use limited to: Digital University Kerala. Downloaded on November 17,2023 at 05:42:21 UTC from IEEE Xplore. Restrictions apply. © 2023 IEEE. Personal use is permitted, but republication/redistribution requires IEEE permission.(cid:13)(cid:10)See https://www.ieee.org/publications/rights/index.html for more information.This article has been accepted for publication in IEEE Internet of Things Journal. This is the author's version which has not been fully edited and content may change prior to final publication. Citation information: DOI 10.1109/JIOT.2023.3325996 8 basedonitstailsandsendsthechallengeciphertextaboutm and select γ ,γ ,γ ,µ randomly from Z , then chooses two σ 1 2 3 p encrypted with A∗ to B, denote as (A∗,c ,c ,...,c ,ct′). hash function H : G → Z∗ and H : {0,1}∗ → G . B lets B selects m′ ∈ G,Q ∈ G T and sˆ 1 ,sˆ 2 fro 0 m 1 Z p ran n d 1 omly. φ = gζ,ϕ = gµ and T compu p tes H 1 = hα1,H 2 = h T α2,T 1 = The simulator B computes e 0 = (H 1 sˆ1,H 2 sˆ2,hsˆ1+sˆ2) and for e(g,h)γ1α1+γ3,T 2 =e(g,h)γ2α2+γ3. Then B sends the public k =1,2,3andi=1,...,n 1 ,B computese i,k =H(f(i)k1)sˆ1· parameters PP =(φ,ϕ,H 1 ,H 2 ,T 1 ,T 2 ,H,H) to A. H(f(i)k2)sˆ2· (cid:81)n j= 2 1 [H(0jk1)sˆ1·H(0jk2)sˆ2]M i ∗ ,j. B sets e i = •Query.AqueriesaprivatekeyontheattributesetS.AsB (e i,1 ,e i,2 ,e i,3 ). Then B computes ct′′ = T 1 sˆ1 ·T 2 sˆ2 ·m′ and holds the master private key msk =(g,h,α 1 ,α 2 ,β 1 ,β 2 ,gγ1, setscsum=Q.EventuallyB setschallengeciphertextCT = gγ2,gγ3), B can generate the sk S and provide it to A. ((M∗,f∗),c ,c ,...,c ,ct′,e ,e ,..., e ,ct′′,csum) and • Challenge. A selects an access structure A = (M,f) 0 1 n1 0 1 n1 forwards it to A. and a message m and provides them to the B. Note • Query. This phase is the same as above. that here B is both the simulator and the challenger. • Output. A gives its guess σ′ on σ, B also guesses σ as The simulator B runs the Encrypt(m,(M,τ)) to obtain σ′. Analysis. If A can break our modified scheme, B has c C s T um = = (A φ , H c ( 0 m ,c )ϕ 1 , H . ( . m ., ′ c ) n1 a , n c d t′ m ,e ′ 0 is ,e r 1 a , n . d .. o , m e n ly 1 , s c e t l ′ e ′, c c te s d um du ) r , in w g h t e h re e the same advantage to compromise the FAME scheme. The encryption process. B sends CT to the A. simulation in the game works perfectly, except that during • Query. This phase is the same as above. the challenge phase, instead of providing the calculated check • Output. A gives a revoked ciphertext under the revoked valuecsum=φH(m)ϕH(m′),BreturnsarandomvalueQfrom access structure CT′ =(A′ =(M′,τ′),c¯ ,c¯ ,...,c¯ ,c ¯ t′,e¯ , thegroupG T .TheimportantpointisthatAisunawareofthe e¯ ,...,e¯ ,c ¯ t′′,csum). 0 1 n′ 1 0 value of m′, so the random value Q has the same statistical 1 At th n is ′ 1 point, simulator B can choose an attribute set S′ distribution as the calculated check value csum. This means that satisfies the revoked access structure M′ and then use that the computed csum and the random value Q look the the master private key to generate the corresponding private same from A’s perspective. keysk , which is then used to decrypt CT′ to obtain the S′ Theorem 2. The revocable FAME with data integrity scheme encrypted message. Denote the decrypted real message and is fully IND-CPA secure if the modified FAME scheme is fully random message to be m¯ and m ¯′ respectively. If A can break IND-CPA secure. dataintegrity,thenitmeansm¯ ̸=mandm ¯′ ̸=m′ butcsum= csum.SothatB cancalculateζ bythefollowingcomputation Proof: First, in the revocable FAME with data integrity and return ζ as its answer for discrete logarithm assumption. scheme, the ciphertext generated by encryption algorithm Encrypt before revocation is the same as the ciphertext in csum=csum⇔φH(m)ϕH(m ′ ) =φH(m¯)ϕH(m ¯′) the modified FAME scheme. We call the ciphertext generated by Encrypt the original ciphertext, so the original ciphertext ⇔gζ·H(m)+µ·H(m ′ ) =gζ·H(m¯)+µ·H(m ¯′) generated by encryption in RFAME-DI achieves the same ⇔ζ·(H(m)−H(m¯))=µ·(H(m ¯′)−H(m ′ )) full security as the modified FAME scheme. Second, we show that the revoked ciphertext generated by the revocation ⇒ζ = µ·(H(m ¯′)−H(m ′ )). Revoke and the ciphertext produced during encryption are H(m)−H(m¯) identically distributed, i.e., these two are indistinguishable from the adversary’s view. In our RFAME-DI scheme, the Analysis. The simulation of B in the game is flawless, and ciphertext generated by the Revoke is the elements in the G T the B’s advantage in solving the discrete logarithmic hard generated by the value s + s′ and s + s′. Where s′,s′ 1 1 2 2 1 2 problemisidenticaltotheadversaryA’sadvantageinwinning are chosen randomly and s ,s are in the original ciphertext. 1 2 the above game. So in the adversary’s view s + s′ and s + s′ are also 1 1 2 2 chosen randomly. Thus the revocation ciphertext generated withrandomvalues +s′,s +s′ andtheciphertextgenerated VI. IMPLEMENTATION&EVALUATION 1 1 2 2 bydirectlyencryptingundertheaccessstructure(M′,τ′)with We put our scheme into action and assess its feasibility by randomly selected value s′′,s′′ are identically distributed, i.e., considering the computational expenses involved, we also do 1 2 indistinguishable from the adversary’s viewpoint. a property-wise comparison of our scheme with other RABE schemes [22], [27], [31], [45] in Table II. Theorem 3. If the discrete logarithm assumption holds, the We implement our scheme on a laptop with AMD’s CPU. revocable FMAE scheme captures the data integrity. It’sRyzon75800H@3.2GHzwith4GBRAM.Boththeclient Proof: If a malicious A attempts to compromise the and cloud server utilize the Linux Ubuntu 20.04 operating RFAME-DIscheme’sintegrity,itimpliestheexistenceofsim- system. We use the library charm 0.5.0 in Python to write the ulator B to address the discrete logarithm problem. Simulator code and run it with version 2.7.15 of Python. It is possible B inputs a discrete logarithm instance, represented by the to carry our scheme on type III curves, such as MNT and parameters (p,G,G ,e,g,gζ). Its objective is to get the ζ BN curves, but some MNT and BN curves are known to be T as the output. insecure in some parameters, so be sure to choose elliptic • Setup. B sets a bilinear group system of prime order curves carefully when implementing cryptographic schemes. (p,G,G ,e,g). B selects α ,α ,β ,β randomly from Z∗ We implement our scheme on the type III curve MNT224 T 1 2 1 2 p Authorized licensed use limited to: Digital University Kerala. Downloaded on November 17,2023 at 05:42:21 UTC from IEEE Xplore. Restrictions apply. © 2023 IEEE. Personal use is permitted, but republication/redistribution requires IEEE permission.(cid:13)(cid:10)See https://www.ieee.org/publications/rights/index.html for more information.9 TABLEII COMPARISONOFVARIOUSRABESCHEMES Scheme Typeofrevocation Dataintegrity Attributespace Arbitraryattributes Security ComputationCostindecryption [22] Re-encryption Yes Bounded No Selective Linear [27] Direct No Bounded No Selective Linear [31] Indirect No Bounded No Selective Constant [45] Indirect No Unbounded Yes Full Constant Ours Re-encryption Yes Unbounded Yes Full Constant in PBC, which is widely acknowledged for its exceptional balance between security and efficiency. Since there are AND-gates and OR-gates in the randomly generated access structure, how many attributes are used in decryption is not determined by the access structure size, and onlysomeattributesareneededtoparticipateinthecalculation tocompletethedecryption.Therefore,theaccessstructurewe generate for testing only contains AND-gates, the goal is to ensure that the amount of attributes needed for decryption matches the access structure size. We also do the same test 50 times and averaged the results to get more realistic and accuratetimedata.Specificallyintheexperiment,forthethree algorithms Encrypt, Decrypt , and Revoke, the attribute set or and access structure are adjusted in increments of 10, ranging from a minimum of 10 to a maximum of 100. The horizontal coordinates of the experimental images of Revoke represent the size of A′. For the algorithm Decrypt , the access re structuresizeisfrom20to200withastepof20.Infact,there is no difference between the two algorithms Decrypt and or Decrypt ,butDecrypt doesonemoreequationverification re re operation than Decrypt , i.e., verifying whether the CT or csum item from the original ciphertext is equal to csum in the revoked ciphertext, and this operation is very light and its time consumption is negligible. We can see from the Fig.4 and Fig.6 that the performance of the Decrypt algorithm is re almost the same as that of the Decrypt algorithm in the set or size range from 10 to 100. 1000 800 600 400 200 0 0 20 40 60 80 100 )sm( noitpyrcnE 600 500 400 300 200 100 0 0 20 40 60 80 100 Our Scheme Scheme[18] Access policy size Fig.3. EncryptiontimeofRFAME-DIschemeandcomparedscheme Wecompareourschemewiththescheme[22].FromFig.6- 9, we see that our scheme outperforms the scheme [22] in all fourphases:encryption,decryption,revocation,anddecryption )sm( noitpyrceD Our Scheme Scheme[18] Attribute set size Fig.4. DecryptiontimeofRFAME-DIschemeandcomparedscheme 2000 1500 1000 500 0 0 50 100 150 200 )sm( noitacoveR This article has been accepted for publication in IEEE Internet of Things Journal. This is the author's version which has not been fully edited and content may change prior to final publication. Citation information: DOI 10.1109/JIOT.2023.3325996 Our Scheme Scheme[18] Revoked access policy size Fig.5. RevocationtimeofRFAME-DIschemeandcomparedscheme oftherevokedciphertext.Especiallyinthedecryptionphases, where the time consumed in our scheme for decryption is independent of the set size, which is stable at about 36ms regardless of the set size. This is because the decryption processofFAMEonlyneeds6pairingoperations.Ourscheme has acceptable disadvantages and very large advantages in practical applications. Because the KGC, which has adequate computational capability, manages key generation and the algorithm is usually executed only once for one user. The client device handles both encryption and decryption tasks, so it’s crucial for the computational load to be as minimal as possible.SinceABEisaone-to-manyencryptiontechnique,so decryptionoccursmorefrequentlythanencryptioninpractical scenarios. Our scheme happens to exactly has a significant advantage in decryption. Authorized licensed use limited to: Digital University Kerala. Downloaded on November 17,2023 at 05:42:21 UTC from IEEE Xplore. Restrictions apply. © 2023 IEEE. Personal use is permitted, but republication/redistribution requires IEEE permission.(cid:13)(cid:10)See https://www.ieee.org/publications/rights/index.html for more information.10 1200 1000 800 600 400 200 0 0 50 100 150 200 )sm( noitpyrced txetrehpic dekoveR This article has been accepted for publication in IEEE Internet of Things Journal. This is the author's version which has not been fully edited and content may change prior to final publication. Citation information: DOI 10.1109/JIOT.2023.3325996 Our Scheme [8] A. Sahai, H. Seyalioglu, and B. Waters, “Dynamic credentials and Scheme[18] ciphertextdelegationforattribute-basedencryption,”AdvancesinCryp- tology-CRYPTO2012,LNCS,vol.7417,pp.199–217,2012. [9] R.Zhang,J.Li,Y.Lu,J.Han,andY.Zhang,“Keyescrow-freeattribute based encryption with user revocation,” Inf. Sci., vol. 600, pp. 59–72, 2022. [10] Y.Guo,Z.Lu,H.Ge,andJ.Li,“Revocableblockchain-aidedattribute- based encryption with escrow-free in cloud storage,” IEEE Trans. Computers,vol.72,no.7,pp.1901–1912,2023. [11] J. Li, R. Zhang, Y. Lu, J. Han, Y. Zhang, W. Zhange, and X. Dong, “Multi-authority attribute-based encryption for assuring data deletion,” IEEESystemsJournal,2022. [12] J. Li, Y. Zhang, J. Ning, X. Huang, G. S. Poh, and D. Wang, “At- tribute based encryption with privacy protection and accountability for cloudiot,” IEEE Trans. Cloud Comput., vol. 10, no. 2, pp. 762–773, 2022. [13] J.HurandD.K.Noh,“Attribute-basedaccesscontrolwithefficientre- Access policy size vocationindataoutsourcingsystems,”IEEETrans.ParallelDistributed Fig. 6. Revoked ciphertext decryption time of RFAME-DI scheme and Syst.,vol.22,no.7,pp.1214–1221,2011. comparedscheme [14] J. Li, X. Huang, J. Li, X. Chen, and Y. Xiang, “Securely outsourc- ing attribute-based encryption with checkability,” IEEE Trans. Parallel DistributedSyst.,vol.25,no.8,pp.2201–2210,2014. [15] J.Li,Y.Wang,Y.Zhang,andJ.Han,“Fullverifiabilityforoutsourced Theoutcomesoftheexperimentshowtheeffectivenessand decryption in attribute based encryption,” IEEE Trans. Serv. Comput., feasibilityof our revocationscheme inensuring dataintegrity. vol.13,no.3,pp.478–487,2020. [16] N.Chen,J.Li,Y.Zhang,andY.Guo,“EfficientCP-ABEschemewith shared decryption in cloud storage,” IEEE Trans. Computers, vol. 71, VII. CONCLUSION no.1,pp.175–184,2022. Inthispaper,weintroduceapracticalandeffectiveRFAME [17] S.AgrawalandM.Chase,“FAME:fastattribute-basedmessageencryp- tion,”inProceedingsofthe2017ACMSIGSACConferenceonComputer scheme designed to safeguard the data integrity on the cloud, andCommunicationsSecurity. ACM,2017,pp.665–682. thereby minimizing performance limitations both for the data [18] D. Riepel and H. Wee, “FABEO: fast attribute-based encryption with users and the cloud. We reduce the security of our scheme optimal security,” in Proceedings of the 2022 ACM SIGSAC Confer- ence on Computer and Communications Security, H. Yin, A. Stavrou, to the FAME scheme to show its full security. We also C.Cremers,andE.Shi,Eds. ACM,2022,pp.2491–2504. demonstrate the data integrity of our scheme in an adaptive [19] M. Ambrona, G. Barthe, R. Gay, and H. Wee, “Attribute-based en- model under discrete logarithm assumption. Furthermore, we cryption in the generic group model: Automated proofs and new constructions,” in Proceedings of the 2017 ACM SIGSAC Conference conduct simulation experiments and experimental analysis in- on Computer and Communications Security. ACM, 2017, pp. 647– dicates that our scheme’s efficiency surpasses the comparison 664. scheme in encryption, decryption, and revocation algorithms. [20] R.Ostrovsky,A.Sahai,andB.Waters,“Attribute-basedencryptionwith non-monotonic access structures,” in Proceedings of the 2007 ACM In addition, our scheme achieves efficient attribute-based re- ConferenceonComputerandCommunicationsSecurity. ACM,2007, vocation while protecting data integrity, but the essence of pp.195–203. revocation is an update of the access structure. It will affect [21] V.Goyal,A.Jain,O.Pandey,andA.Sahai,“Boundedciphertextpolicy attributebasedencryption,”inAutomata,LanguagesandProgramming, theaccessofsomedatauserstothefile.Ourfutureworkisto 35thInternationalColloquium,vol.5126. Springer,2008,pp.579–591. implementmorefine-grainedrevocation,enablingdataowners [22] C. Ge, W. Susilo, J. Baek, Z. Liu, J. Xia, and L. Fang, “Revocable to withdraw access to a single file for a specific user. attribute-based encryption with data integrity in clouds,” IEEE Trans. DependableSecur.Comput.,vol.19,no.5,pp.2864–2872,2022. [23] N. Attrapadung, B. Libert, and E. de Panafieu, “Expressive key-policy REFERENCES attribute-basedencryptionwithconstant-sizeciphertexts,”inPublicKey Cryptography-PKC2011,LNCS,vol.6571. Springer,2011,pp.90– [1] Z. Kang, J. Li, J. Shen, J. Han, Y. Zuo, and Y. Zhang, “TFS-ABS: 108. traceable and forward-secure attribute-based signature scheme with [24] J.Han,W.Susilo,Y.Mu,andJ.Yan,“Privacy-preservingdecentralized constant-size,”IEEETrans.Knowl.DataEng.,vol.35,no.9,pp.9514– key-policyattribute-basedencryption,”IEEETrans.ParallelDistributed 9530,2023. Syst.,vol.23,no.11,pp.2150–2162,2012. [2] Y.Chen,J.Li,C.Liu,J.Han,Y.Zhang,andP.Yi,“Efficientattribute [25] J.Li,W.Yao,J.Han,Y.Zhang,andJ.Shen,“Usercollusionavoidance based server-aided verification signature,” IEEE Trans. Serv. Comput., CP-ABEwithefficientattributerevocationforcloudstorage,”IEEESyst. vol.15,no.6,pp.3224–3232,2022. J.,vol.12,no.2,pp.1767–1777,2018. [3] J.Li,Y.Chen,J.Han,C.Liu,Y.Zhang,andH.Wang,“Decentralized [26] J. Li, W. Yao, Y. Zhang, H. Qian, and J. Han, “Flexible and fine- attribute-based server-aid signature in the internet of things,” IEEE grained attribute-based data storage in cloud computing,” IEEE Trans. InternetThingsJ.,vol.9,no.6,pp.4573–4583,2022. Serv.Comput.,vol.10,no.5,pp.785–796,2017. [4] L. Zhang, H. Xiong, Q. Huang, J. Li, K. R. Choo, and J. Li, [27] J.K.Liu,T.H.Yuen,P.Zhang,andK.Liang,“Time-baseddirectrevo- “Cryptographic solutions for cloud storage: Challenges and research cableciphertext-policyattribute-basedencryptionwithshortrevocation opportunities,”IEEETrans.Serv.Comput.,vol.15,no.1,pp.567–587, list,”inAppliedCryptographyandNetworkSecurity,ACNS2018,LNCS, 2022. vol.10892. Springer,2018,pp.516–534. [5] A. Sahai and B. Waters, “Fuzzy identity-based encryption,” in 24th [28] Y. Shi, Q. Zheng, J. Liu, and Z. Han, “Directly revocable key-policy Annual International Conference on the Theory and Applications of attribute-basedencryptionwithverifiableciphertextdelegation,”Inf.Sci., CryptographicTechniques. Springer,2005,pp.457–473. vol.295,pp.221–231,2015. [6] B.Waters,“Ciphertext-policyattribute-basedencryption:Anexpressive, [29] H. Wang, Z. Zheng, L. Wu, and P. Li, “New directly revocable efficient,andprovablysecurerealization,”in14thInternationalConfer- attribute-based encryption scheme and its application in cloud storage ence on Practice and Theory in Public Key Cryptography, vol. 6571. environment,”Clust.Comput.,vol.20,no.3,pp.2385–2392,2017. Springer,2011,pp.53–70. [30] Y.Yang,J.K.Liu,K.Liang,K.R.Choo,andJ.Zhou,“Extendedproxy- [7] K.B.Frikken,M.J.Atallah,andJ.Li,“Attribute-basedaccesscontrol assistedapproach:Achievingrevocablefine-grainedencryptionofcloud with hidden policies and hidden credentials,” IEEE Trans. Computers, data,”in20thEuropeanSymposiumonResearchinComputerSecurity, vol.55,no.10,pp.1259–1270,2006. vol.9327. Springer,2015,pp.146–166. Authorized licensed use limited to: Digital University Kerala. Downloaded on November 17,2023 at 05:42:21 UTC from IEEE Xplore. Restrictions apply. © 2023 IEEE. Personal use is permitted, but republication/redistribution requires IEEE permission.(cid:13)(cid:10)See https://www.ieee.org/publications/rights/index.html for more information.This article has been accepted for publication in IEEE Internet of Things Journal. This is the author's version which has not been fully edited and content may change prior to final publication. Citation information: DOI 10.1109/JIOT.2023.3325996 11 [31] H.Cui,R.H.Deng,Y.Li,andB.Qin,“Server-aidedrevocableattribute- Jiguo Li received the Ph.D. degree in computer basedencryption,”inComputerSecurity-ESORICS2016,LNCS,vol. sciencefromHarbinInstituteofTechnology,Harbin, 9879. Springer,2016,pp.570–587. China, in 2003. During 2006.9-2007.3, he was a [32] A.Boldyreva,V.Goyal,andV.Kumar,“Identity-basedencryptionwith visitingscholaratCentreforComputerandInforma- efficient revocation,” in Proceedings of the 2008 ACM Conference on tion Security Research, University of Wollongong, ComputerandCommunicationsSecurity. ACM,2008,pp.417–426. Australia. During 2013.2-2014.1, he was a visiting [33] Y. Jiang, W. Susilo, Y. Mu, and F. Guo, “Ciphertext-policy attribute- scholar in Institute for Cyber Security in the Uni- basedencryptionsupportingaccesspolicyupdateanditsextensionwith versity of Texas at San Antonio. From November preservedattributes,”Int.J.Inf.Sec.,vol.17,no.5,pp.533–548,2018. 2003 to October 2018, he was with the College [34] J.Lai,R.H.Deng,C.Guan,andJ.Weng,“Attribute-basedencryption of Computers and Information, Hohai University, withverifiableoutsourceddecryption,”IEEETrans.Inf.ForensicsSecur., Nanjing,China.Heiscurrentlyaprofessorwiththe vol.8,no.8,pp.1343–1354,2013. CollegeofComputerandCyberSecurity,FujianNormalUniversity,Fuzhou, [35] J. Li, X. Zhao, Y. Zhang, and W. Yao, “Provably secure certificate- China. His research interests include cryptography theory and technology, basedconditionalproxyre-encryption,”J.Inf.Sci.Eng.,vol.32,no.4, informationsecurity,andcloudcomputingsecurityetc.Hehaspublishedover pp.813–830,2016. 200 research papers in refereed international conferences and journals. His [36] Y. Lu and J. Li, “A pairing-free certificate-based proxy re-encryption workhasbeencitedmorethan5000timesatGoogleScholar.Hehasserved schemeforsecuredatasharinginpublicclouds,”FutureGener.Comput. asprogramcommitteememberinover40internationalconferencesandserved Syst.,vol.62,pp.140–147,2016. asthereviewersinover100internationaljournalsandconferences. [37] J. Shao, R. Lu, X. Lin, and K. Liang, “Secure bidirectional proxy re- encryption for cryptographic cloud storage,” Pervasive Mob. Comput., vol.28,pp.113–121,2016. [38] Z. Li, V. Sharma, C. Ma, C. Ge, and W. Susilo, “Ciphertext-policy attribute-basedproxyre-encryptionviaconstrainedprfs,”Sci.ChinaInf. Sci.,vol.64,no.6,2021. [39] F.Luo,S.M.Al-Kuwari,F.Wang,andK.Chen,“Attribute-basedproxy re-encryptionfromstandardlattices,”Theor.Comput.Sci.,vol.865,pp. 52–62,2021. [40] C. Ge, W. Susilo, J. Baek, Z. Liu, J. Xia, and L. Fang, “A verifiable andfairattribute-basedproxyre-encryptionschemefordatasharingin clouds,” IEEE Trans. Dependable Secur. Comput., vol. 19, no. 5, pp. 2907–2919,2022. [41] H. Deng, Z. Qin, Q. Wu, Z. Guan, and Y. Zhou, “Flexible attribute- basedproxyre-encryptionforefficientdatasharing,”Inf.Sci.,vol.511, pp.94–113,2020. [42] A.SadeghiandM.Steiner,“Assumptionsrelatedtodiscretelogarithms: YichenZhangreceivedthePh.D.degreeintheCol- Why subtleties make a real difference,” Advances in Cryptology - legeofComputerandInformation,HohaiUniversity, EUROCRYPT2001,vol.2045,pp.244–261,2001. Nanjing,Chinain2015.Sheiscurrentlyanassociate [43] A. Beimel, “Secure schemes for secret sharing and key distribution,” professor with the College of Mathematics and In- Ph.D.dissertation,Technion-IsraelInstituteofTechnology,Israel,1996. formatics,FujianNormalUniversity,Fuzhou,China. [44] Z.LiuandZ.Cao,“Onefficientlytransferringthelinearsecret-sharing Herresearchinterestsincludecryptography,network scheme matrix in ciphertext-policy attribute-based encryption,” IACR security.Shehaspublishedover40researchpapers Cryptol.ePrintArch.,p.374,2010. inrefereedinternationalconferencesandjournals. [45] S. Xu, J. Ning, J. Ma, G. Xu, J. Yuan, and R. H. Deng, “Revocable policy-based chameleon hash,” in 26th European Symposium on Re- search in Computer Security, ser. Lecture Notes in Computer Science, E.Bertino,H.Shulman,andM.Waidner,Eds.,vol.12972. Springer, 2021,pp.327–347. Jinguang Han obtainedhisPhDdegreefromUni- ShaoBo Chen received the B.S. degree in math- versity of Wollongong, Australia, in 2013. He is ematics from Southern University of Science and a professor at the School of Cyber Science and Technology,China,in2019.HeisworkingforM.S. Engineering, Southeast University, China. His re- degreeintheCollegeofComputerandCyberSecu- searchinterestsincludecryptography,accesscontrol, rity, Fujian Normal University, Fuzhou, China. His blockchain,privacy-preservingsystems,cloudcom- researchinterestsincludeattribute-basedencryption, putingandnetworksecurity.Heisaseniormember couldsecurityandprivacy. ofACMandIEEE. Authorized licensed use limited to: Digital University Kerala. Downloaded on November 17,2023 at 05:42:21 UTC from IEEE Xplore. Restrictions apply. © 2023 IEEE. Personal use is permitted, but republication/redistribution requires IEEE permission.(cid:13)(cid:10)See https://www.ieee.org/publications/rights/index.html for more information.